<section class="product-detail">

  <div class="wrap">

    <!-- PREVIEW (esquerda) -->
    <section class="preview">
      <div class="stage" id="stage">
        <div class="product-img" id="productImgWrap">
          <img id="productImg" src="https://images.unsplash.com/photo-1602524812973-8a10b5b3e1f0?q=80&w=1400&auto=format&fit=crop" alt="Produto futurista">
        </div>
        <div class="neon-lights"></div>
      </div>

      <div class="thumbnails" style="display:flex;gap:8px;margin-top:12px;justify-content:center;">
        <button class="thumb" data-src="https://images.unsplash.com/photo-1602524812973-8a10b5b3e1f0?q=80&w=1400&auto=format&fit=crop">Mini 1</button>
        <button class="thumb" data-src="https://images.unsplash.com/photo-1612831206022-8b2b0f6d0e09?q=80&w=1400&auto=format&fit=crop">Mini 2</button>
        <button class="thumb" data-src="https://images.unsplash.com/photo-1558980664-10b8f4f2b6ef?q=80&w=1400&auto=format&fit=crop">Mini 3</button>
      </div>
    </section>

    <!-- INFO (direita) -->
    <aside class="info">

      <div class="brand">
        <div class="logo">CX</div>
        <div>
          <div class="meta">Produto • Linhagem Tech</div>
          <div style="font-size:12px;color:var(--muted)">SKU: CX-9834-FUT</div>
        </div>
      </div>

      <h1 class="title" id="title">Placa Neural X-2000</h1>

      <p class="desc" id="desc">
        A Placa Neural X-2000 combina processamento paralelo, refrigeração passiva de nova geração e compatibilidade com stacks ML custom. Ideal para devs, criadores e gamers que buscam performance sustentável. Construída com materiais recicláveis e tuning de baixa latência.
      </p>

      <div class="price-row">
        <div>
          <div class="price" id="price">R$ 4.499,00</div>
          <div class="installments" id="installments">ou 6x de R$ 749,83 sem juros</div>
        </div>
        <div style="text-align:right;color:var(--muted);font-size:13px">Em estoque • Envio rápido</div>
      </div>

      <div class="actions">
        <div>
          <div style="font-weight:700;font-size:13px;margin-bottom:6px;color:var(--muted)">TAMANHOS / VERSÕES</div>
          <div class="sizes" role="tablist" id="sizesList">
            <button class="size-btn active" data-size="Standard" aria-selected="true">STD</button>
            <button class="size-btn" data-size="Pro" aria-selected="false">Pro</button>
            <button class="size-btn" data-size="Ultra" aria-selected="false">Ultra</button>
          </div>
        </div>

        <button class="btn-buy" id="buyBtn" aria-pressed="false">
          Adicionar ao carrinho
          <span class="badge" id="priceBadge">R$ 4.499</span>
        </button>
      </div>

      <div class="extras">
        <div class="extra-line">
          <div>
            <div style="font-weight:700">Frete</div>
            <div style="font-size:13px;color:var(--muted)">Calcule por CEP</div>
          </div>
          <div style="display:flex;gap:8px;align-items:center;">
            <div class="cep-row">
              <input id="cepInput" type="text" placeholder="00000-000" aria-label="CEP">
              <button id="cepBtn">Calcular</button>
            </div>
          </div>
        </div>

        <div class="extra-line" id="shippingResult" style="display:none;">
          <div id="shipText">—</div>
          <div id="shipPrice" style="font-weight:800"></div>
        </div>

        <div class="extra-line">
          <div>
            <div style="font-weight:700">Garantia</div>
            <div style="font-size:13px;color:var(--muted)">12 meses + suporte premium</div>
          </div>
          <div style="color:var(--muted);font-size:13px">Saiba mais</div>
        </div>
      </div>

      <!-- Reviews simplificado -->
      <div style="margin-top:12px">
        <div style="font-weight:700">Avaliações</div>
        <div class="reviews" id="reviews">
          <div class="review-summary">
            <div class="stars" id="reviewStars">★★★★★</div>
            <div class="review-text" id="reviewText">Produto altamente avaliado por desempenho e design futurista.</div>
          </div>
        </div>
      </div>

    </aside>

  </div>
</section>

<style>

</style>


        <section class="product-detail">

            <div class="wrap">

                <!-- PREVIEW (esquerda) -->
                <section class="preview">
                    <div class="stage" id="stage">
                        <div class="product-img" id="productImgWrap">
                            <img id="productImg" src="geral/img/perifericos/headset.png" alt="Produto futurista">
                        </div>
                        <div class="neon-lights"></div>
                    </div>


                </section>

                <!-- INFO (direita) -->
                <aside class="info">

                    <div class="brand">
                        <div class="logo"><img src="geral/img/logo/simbolo.png" alt=""></div>
                        <div>
                            <div class="meta">Produto • Linhagem Tech</div>
                            <div style="font-size:12px;">SKU: CX-9834-FUT</div>
                        </div>
                    </div>

                    <h1 class="title" id="title">Placa Neural X-2000</h1>

                    <p class="desc" id="desc">
                        A Placa Neural X-2000 combina processamento paralelo, refrigeração passiva de nova geração e
                        compatibilidade com stacks ML custom. Ideal para devs, criadores e gamers que buscam performance
                        sustentável. Construída com materiais recicláveis e tuning de baixa latência.
                    </p>

                    <div class="price-row">
                        <div>
                            <div class="price" id="price">R$ 4.499,00</div>
                            <div class="installments" id="installments">ou 6x de R$ 749,83 sem juros</div>
                        </div>
                        <div style="text-align:right;;font-size:13px">Em estoque • Envio rápido</div>
                    </div>

                    <div class="actions">
                        <div>
                            <div style="font-weight:700;font-size:13px;margin-bottom:6px;">TAMANHOS /
                                VERSÕES</div>
                            <div class="sizes" role="tablist" id="sizesList">
                                <button class="size-btn active" data-size="Standard" aria-selected="true">STD</button>
                                <button class="size-btn" data-size="Pro" aria-selected="false">Pro</button>
                                <button class="size-btn" data-size="Ultra" aria-selected="false">Ultra</button>
                            </div>
                        </div>

                        <button class="btn-buy" id="buyBtn" aria-pressed="false">
                            Adicionar ao carrinho
                            <span class="badge" id="priceBadge">R$ 4.499</span>
                        </button>
                    </div>

                    <div class="extras">
                        <div class="extra-line">
                            <div>
                                <div style="font-weight:700">Frete</div>
                                <div style="font-size:13px;">Calcule por CEP</div>
                            </div>
                            <div style="display:flex;gap:8px;align-items:center;">
                                <div class="cep-row">
                                    <input id="cepInput" type="text" placeholder="00000-000" aria-label="CEP">
                                    <button id="cepBtn">Calcular</button>
                                </div>
                            </div>
                        </div>

                        <div class="extra-line" id="shippingResult" style="display:none;">sau
                            <div id="shipText">—</div>
                            <div id="shipPrice" style="font-weight:800"></div>
                        </div>

                        <div class="extra-line">
                            <div>
                                <div style="font-weight:700">Garantia</div>
                                <div style="font-size:13px;">12 meses + suporte premium</div>
                            </div>
                            <div style="font-size:13px"><a href="warranty.html"></a>Saiba mais</div>
                        </div>
                    </div>

                    <!-- Reviews simplificado -->
                    <div style="margin-top:12px">
                        <div style="font-weight:700">Avaliações</div>
                        <div class="reviews" id="reviews">
                            <div class="review-summary">
                                <div class="stars" id="reviewStars">★★★★★</div>
                                <div class="review-text" id="reviewText">Produto altamente avaliado por desempenho e
                                    design
                                    futurista.</div>
                            </div>
                        </div>
                    </div>

                </aside>


            </div>
        </section>
        <section class="tabs__products">
            <div class="product-tabs">
                <button class="tab active" data-tab="descricao">Descrição Geral</button>
                <button class="tab" data-tab="garantia">Garantia</button>
                <button class="tab" data-tab="pagamento">Formas de Pagamento</button>
            </div>

            <!-- CONTENTS -->

            <div class="tab-content active" id="descricao">
                <h3>Descrição do PC</h3>
                <p> A Placa Neural X-2000 combina processamento paralelo, refrigeração passiva de nova geração e
                    compatibilidade com stacks ML custom. Ideal para devs, criadores e gamers que buscam performance
                    sustentável. Construída com materiais recicláveis e tuning de baixa latência.
                </p>
            </div>

            <div class="tab-content" id="garantia">
                <h3>Garantia</h3>
                <p>
                    Todos os produtos acompanham <strong>12 meses de garantia</strong> contra defeitos de fábrica,
                    além de <strong>suporte técnico especializado</strong> via e-mail e telefone.
                </p>
                <p>
                    Caso seja necessário acionar a garantia, o cliente deverá entrar em contato com o suporte
                    para orientações de envio e troca.
                </p>
            </div>

            <div class="tab-content" id="pagamento">
                <h3>Formas de Pagamento</h3>
                <ul>
                    <li><strong>Cartão de Crédito:</strong> até 10x sem juros</li>
                    <li><strong>Boleto Bancário:</strong> à vista com desconto</li>
                    <li><strong>Pix:</strong> pagamento instantâneo com desconto exclusivo</li>
                    <li><strong>Carteiras Digitais:</strong> compatível com Apple Pay, Google Pay e PayPal</li>
                </ul>
            </div>
        </section>



        .product-detail {
    display: flex;
    justify-content: center;
    align-items: center;
    padding: clamp(1rem, 5vw, 2em);
    min-height: 100vh;
    background: var(--body-color);
    color: var(--text-color);
}

.product-detail .wrap {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
    gap: clamp(1rem, 2vw, 2.5rem);
    width: 100%;
    max-width: 1200px;
    background: var(--container-color);
    border-radius: 1rem;
    box-shadow: 0 0 20px var(--shadow-color);
    padding: clamp(1rem, 2vw, 2rem);
}

/* ====================== PREVIEW ====================== */
.preview {
    display: flex;
    justify-content: center;
    align-items: center;
}

.stage {
    position: relative;
    border-radius: 1rem;
    padding: 2rem;
    overflow: hidden;
    box-shadow: inset 0 0 40px rgba(255, 255, 255, 0.05);
    transition: transform 0.3s ease;
}

.stage:hover {
    transform: scale(1.02);
}

.stage img {
    max-width: 100%;
    display: block;
}

.neon-lights {
    position: absolute;
    inset: 0;
    pointer-events: none;
    background: linear-gradient(45deg,
            var(--first-color) 0%,
            transparent 40%,
            transparent 60%,
            var(--first-color-light) 100%);
    mix-blend-mode: overlay;
    opacity: 0.2;
    animation: pulse 2s infinite ease-in-out;
}

@keyframes pulse {

    0%,
    100% {
        opacity: 0.2;
    }

    50% {
        opacity: 0.35;
    }
}

/* ====================== INFO SIDE ====================== */
.info {
    display: flex;
    flex-direction: column;
    gap: 1rem;
}

.brand {
    display: flex;
    align-items: center;
    gap: 0.8rem;
    font-size: var(--small-font-size);
    color: var(--text-color);
}

.brand .logo img {
    width: 40px;
    height: 40px;
    object-fit: contain;
}

.desc {
    font-size: var(--normal-font-size);
    line-height: 1.6;
    color: var(--text-color);
    max-height: 200px;
    overflow-y: auto;
}

.price-row {
    display: flex;
    justify-content: space-between;
    align-items: center;
    border-top: 1px solid var(--shadow-color);
    padding-top: 1rem;
    flex-wrap: wrap;
    gap: 1rem;
}

.price {
    font-size: var(--large-font-size);
    font-weight: 700;
    color: var(--first-color);
}

.installments {
    font-size: var(--small-font-size);
    color: var(--text-color);
}

/* ====================== ACTIONS ====================== */
.actions {
    display: flex;
    flex-direction: column;
    gap: 1rem;
    margin-top: 1rem;
}

.sizes {
    display: flex;
    gap: 0.5rem;
    flex-wrap: wrap;
}

.size-btn {
    background: var(--body-color);
    border: 1px solid var(--first-color);
    color: var(--title-color);
    padding: 0.5rem 1rem;
    border-radius: 6px;
    font-size: var(--small-font-size);
    cursor: pointer;
    transition: all 0.2s ease;
}

.size-btn.active,
.size-btn:hover {
    background: var(--first-color);
    color: var(--body-color-inverse);
}

.size-btn:focus {
    outline: 2px solid var(--first-color);
    outline-offset: 2px;
}

.btn-buy {
    background: linear-gradient(90deg, var(--first-color), var(--first-color-alt));
    border: none;
    padding: 1rem;
    border-radius: 8px;
    font-size: var(--normal-font-size);
    font-weight: 600;
    color: #fff;
    cursor: pointer;
    display: flex;
    justify-content: space-between;
    align-items: center;
    transition: transform 0.2s ease, box-shadow 0.2s ease;
}

.btn-buy:hover {
    transform: scale(1.03) translateY(-2px);
    box-shadow: 0 0 30px var(--first-color-light);
}

.btn-buy:focus {
    outline: 2px solid var(--first-color);
    outline-offset: 2px;
}

.badge {
    background: var(--body-color-inverse);
    color: var(--first-color);
    padding: 0.3rem 0.6rem;
    border-radius: 6px;
    font-size: var(--small-font-size);
    font-weight: 700;
}

/* ====================== EXTRAS ====================== */
.extras {
    margin-top: 1rem;
    border-top: 1px solid var(--shadow-color);
    padding-top: 1rem;
}

.extra-line {
    display: flex;
    justify-content: space-between;
    align-items: center;
    padding: 0.6rem 0;
    font-size: var(--small-font-size);
}

.cep-row {
    display: flex;
    gap: 0.5rem;
}

.cep-row input {
    background: var(--container-color);
    border: 1px solid var(--shadow-color);
    color: var(--title-color);
    padding: 0.4rem 0.6rem;
    border-radius: 6px;
}

.cep-row button {
    background: var(--first-color);
    color: #fff;
    border: none;
    padding: 0.4rem 0.8rem;
    border-radius: 6px;
    cursor: pointer;
}

/* ====================== REVIEWS ====================== */
.reviews {
    margin-top: 0.8rem;
}

.stars {
    font-size: 1.1rem;
    color: var(--first-color);
    letter-spacing: 1px;
}

.review-text {
    font-size: var(--small-font-size);
    color: var(--text-color);
    line-height: 1.6;
}

/* ====================== TABS ====================== */
.tabs__products {
    max-width: 1200px;
    margin: 0 auto 1rem;
}

.product-tabs {
    display: flex;
    gap: 1rem;
    border-bottom: 1px solid var(--shadow-color);
    padding-bottom: 0.5rem;
}

.tab {
    background: none;
    border: none;
    font-size: var(--normal-font-size);
    font-weight: 500;
    color: var(--text-color);
    cursor: pointer;
    position: relative;
    padding-bottom: 0.4rem;
}

.tab.active {
    color: var(--first-color);
}

.tab.active::after {
    content: "";
    position: absolute;
    left: 0;
    bottom: -2px;
    width: 100%;
    height: 2px;
    background: var(--first-color);
}

.tab-content {
    height: 0;
    overflow: hidden;
    transition: height 0.3s ease;
    color: var(--text-color);
}

.tab-content.active {
    height: auto;
    padding: 1rem 0;
}

/* ====================== RESPONSIVIDADE ====================== */
@media (max-width: 768px) {
    .product-detail .wrap {
        grid-template-columns: 1fr;
        padding: 1rem;
    }

    .price-row {
        flex-direction: column;
        align-items: flex-start;
    }

    .actions {
        flex-direction: column;
    }

    .sizes {
        justify-content: flex-start;
    }
}

pedir para o chat fazer o sistema que adiciona o item com todas as informações mesmo


// window.ProductsApp — ponto único de verdade
window.ProductsApp = window.ProductsApp || {};

// Produtos já armazenados / fallback demo
window.ProductsApp.getProducts = function() {
    if (Array.isArray(window.PRODUCTS) && window.PRODUCTS.length) return window.PRODUCTS;
    
    // fallback localStorage
    try {
        const saved = JSON.parse(localStorage.getItem('products') || '[]');
        if (Array.isArray(saved) && saved.length) {
            window.PRODUCTS = saved;
            return saved;
        }
    } catch(e) { /* ignore */ }

    // se ainda não existir, cria demo
    const demo = [
        {
            id: "1",
            name: "Headphone Cyber Drivers 40mm, Bluetooth, Preto",
            img: "geral/img/perifericos/headset.png",
            price: "R$ 169,99",
            sku: "HD-1234",
            category: "perifericos"
        },
        {
            id: "2",
            name: "Placa Mãe Gigabyte B550M, AMD AM4, Micro ATX",
            img: "geral/img/placa-giga.png",
            price: "R$ 899,99",
            sku: "MB-5678",
            category: "hardware"
        },
        {
            id: "3",
            name: "Placa Mãe Gigabyte B550M, AMD AM4, Micro ATX",
            img: "geral/img/placa-giga.png",
            price: "R$ 899,99",
            sku: "MB-5678",
            category: "hardware"
        }
      ];

    window.PRODUCTS = demo;
    localStorage.setItem('products', JSON.stringify(demo));
    return demo;
};


/* geral/js/item.js  — Versão robusta (substituir arquivo atual) */
/* Dependências opcionais: gsap (para animações). Usa ViaCEP para consulta de CEP. */

(function () {
    'use strict';

    document.addEventListener('DOMContentLoaded', () => {
        /* ================= CONFIG / PRODUTOS (usa window.products se existir) ================= */
        const PRODUCTS = window.products || [
            {
                id: "1",
                name: "Headphone Cyber Drivers 40mm, Bluetooth, Preto",
                img: "geral/img/perifericos/headset.png",
                price: "R$ 169,99",
                sku: "HD-1234",
                brandMeta: "Produto • Linhagem Tech",
                description: "Headphone Bluetooth com drivers de 40mm...",
                installments: "ou 6x de R$ 28,33 sem juros",
                stock: "Em estoque • Envio rápido",
                rating: 4.5,
                reviewText: "Produto bem avaliado por conforto e som limpo",
                category: "periferico"
            },
            {
                id: "2",
                name: "Placa Mãe Gigabyte B550M, AMD AM4, Micro ATX",
                img: "geral/img/placa-giga.png",
                price: "R$ 899,99",
                sku: "MB-5678",
                brandMeta: "Produto • Linhagem Tech",
                description: "Placa mãe AMD B550M com suporte DDR4...",
                installments: "ou 12x de R$ 74,99 sem juros",
                stock: "Em estoque • Envio rápido",
                rating: 4.8,
                reviewText: "Altamente confiável e durável",
                category: "hardware"
            },
            {
                id: "3",
                name: "Placa Mãe Gigabyte B550M, AMD AM4, Micro ATX",
                img: "geral/img/placa-giga.png",
                price: "R$ 899,99",
                sku: "MB-5678",
                brandMeta: "Produto • Linhagem Tech",
                description: "Placa mãe AMD B550M com suporte DDR4...",
                installments: "ou 12x de R$ 74,99 sem juros",
                stock: "Em estoque • Envio rápido",
                rating: 4.8,
                reviewText: "Altamente confiável e durável",
                category: "hardware"
            }
            
        ];

        /* ================= ELEMENTOS DO DOM ================= */
        const getEl = id => document.getElementById(id);

        const titleEl = getEl('title');
        const descEl = getEl('desc');
        const priceEl = getEl('price');
        const priceBadgeEl = getEl('priceBadge');
        const productImgEl = getEl('productImg');
        const skuEl = getEl('sku');
        const brandMetaEl = getEl('brandMeta');
        const installmentsEl = getEl('installments');
        const stockEl = getEl('stock');
        const reviewStarsEl = getEl('reviewStars');
        const reviewTextEl = getEl('reviewText');
        const relatedContainer = getEl('relatedProducts');

        const buyBtn = getEl('buyBtn');
        // cart badge in header — tenta vários seletores conhecidos
        let cartBadge = document.querySelector('#cart-badge, #number-text, [data-cart-badge], .cart-badge');

        // CEP elements (podem ser null — tratamos)
        const cepInput = getEl('cepInput');
        const cepBtn = getEl('cepBtn');

        // helper: cria shippingResult se não existir e retorna referências
        function ensureShippingElements() {
            let shippingResult = getEl('shippingResult');
            let shipText = getEl('shipText');
            let shipPrice = getEl('shipPrice');

            if (!shippingResult) {
                shippingResult = document.createElement('div');
                shippingResult.id = 'shippingResult';
                // manter compatibilidade com seu CSS (classe .show aplicada pelo JS)
                shippingResult.style.display = 'none';
                shippingResult.style.marginTop = '0.6rem';
                // inserir após o bloco do CEP se possível, senão no final do aside
                if (cepInput && cepInput.parentNode) cepInput.parentNode.insertAdjacentElement('afterend', shippingResult);
                else {
                    const aside = document.querySelector('.info') || document.body;
                    aside.appendChild(shippingResult);
                }
            }
            if (!shipText) {
                shipText = document.createElement('span');
                shipText.id = 'shipText';
                shippingResult.appendChild(shipText);
            }
            if (!shipPrice) {
                shipPrice = document.createElement('span');
                shipPrice.id = 'shipPrice';
                shipPrice.style.marginLeft = '0.5rem';
                shippingResult.appendChild(shipPrice);
            }
            return { shippingResult, shipText, shipPrice };
        }

        /* ================ UTIL: Toast (usa showToast se já existir) ================ */
// Container para todas as notificações
if (!document.getElementById('toast-container')) {
    const container = document.createElement('div');
    container.id = 'toast-container';
    Object.assign(container.style, {
        position: 'fixed',
        top: '80px',
        right: '20px',
        display: 'flex',
        flexDirection: 'column',
        gap: '10px', // espaço entre notificações
        zIndex: 99999,
        pointerEvents: 'none'
    });
    document.body.appendChild(container);
}

function localToast(msg) {
    const container = document.getElementById('toast-container');
    if (!container) return;

    const t = document.createElement('div');
    t.textContent = msg;

    Object.assign(t.style, {
        maxWidth: '300px',
        background: `linear-gradient(90deg, var(--first-color), var(--first-color-alt))`,
        color: `white`,
        padding: '12px 16px',
        borderRadius: '8px',
        boxShadow: '0 8px 20px rgba(0,0,0,0.25)',
        fontSize: '14px',
        lineHeight: '1.4',
        opacity: 0,
        transform: 'translateY(-20px)',
        pointerEvents: 'auto',
        transition: 'all 0.4s ease'
    });

    container.appendChild(t);

    // Entrada animada
    if (window.gsap) {
        gsap.to(t, { opacity: 1, y: 0, duration: 0.3, ease: "power2.out" });
    } else {
        t.style.opacity = 1;
        t.style.transform = 'translateY(0)';
    }

    // Remove após 1,5s
    setTimeout(() => {
        if (window.gsap) {
            gsap.to(t, { opacity: 0, y: -20, duration: 0.4, ease: "power2.in", onComplete: () => t.remove() });
        } else {
            t.remove();
        }
    }, 1500);
}



        /* ================ UTIL: anima show/hide com gsap fallback ================ */
        function showNode(node) {
            if (!node) return;
            node.style.display = 'flex';
            node.classList && node.classList.add('show');
            if (window.gsap && typeof gsap.fromTo === 'function') {
                gsap.fromTo(node, { opacity: 0, y: 8 }, { opacity: 1, y: 0, duration: 0.35 });
            } else {
                node.style.opacity = 0;
                node.style.transform = 'translateY(8px)';
                requestAnimationFrame(() => {
                    node.style.transition = 'opacity .35s, transform .35s';
                    node.style.opacity = 1;
                    node.style.transform = 'translateY(0)';
                });
            }
        }

        function hideNode(node) {
            if (!node) return;
            if (window.gsap && typeof gsap.to === 'function') {
                gsap.to(node, { opacity: 0, y: 8, duration: 0.28, onComplete: () => { node.style.display = 'none'; node.classList && node.classList.remove('show'); } });
            } else {
                node.style.transition = 'opacity .28s, transform .28s';
                node.style.opacity = 0;
                node.style.transform = 'translateY(8px)';
                setTimeout(() => { node.style.display = 'none'; node.classList && node.classList.remove('show'); }, 300);
            }
        }

        /* ================ MÁSCARA SIMPLES PARA CEP (00000-000) ================ */
        function cepMask(e) {
            const el = e.target;
            let v = el.value.replace(/\D/g, '').slice(0, 8);
            if (v.length > 5) v = v.slice(0, 5) + '-' + v.slice(5);
            el.value = v;
        }
        if (cepInput) {
            cepInput.addEventListener('input', cepMask);
        }

        /* ================ PEGAR PRODUTO (pela querystring id) ================ */
        const params = new URLSearchParams(window.location.search);
        const productId = params.get('id');
        const product = PRODUCTS.find(p => p.id === productId) || PRODUCTS[0];
        if (!product) {
            console.warn('Item: produto não encontrado e não há fallback.');
            return;
        }

        /* ================ POPULA DETALHES DO PRODUTO ================ */
        function setProduct(product) {
            if (titleEl) titleEl.textContent = product.name || 'Produto';
            if (descEl) descEl.textContent = product.description || '';
            if (priceEl) priceEl.textContent = product.price || 'R$ 0,00';
            if (priceBadgeEl) priceBadgeEl.textContent = product.price || 'R$ 0,00';
            if (productImgEl && product.img) productImgEl.src = product.img;
            if (skuEl) skuEl.textContent = `SKU: ${product.sku || '—'}`;
            if (brandMetaEl) brandMetaEl.textContent = product.brandMeta || '';
            if (installmentsEl) installmentsEl.textContent = product.installments || '';
            if (stockEl) stockEl.textContent = product.stock || '';
            if (reviewStarsEl) {
                reviewStarsEl.innerHTML = '';
                for (let i = 0; i < 5; i++) {
                    const s = document.createElement('span');
                    s.textContent = i < Math.floor((product.rating || 0)) ? '★' : '☆';
                    // pequenos delays para efeito (se quiser)
                    s.style.opacity = 1;
                    s.style.marginRight = '2px';
                    reviewStarsEl.appendChild(s);
                }
            }
            if (reviewTextEl) reviewTextEl.textContent = product.reviewText || '';
        }
        setProduct(product);

        /* ================ CARRINHO: utilitários ================ */
        function readCart() {
            try {
                const raw = localStorage.getItem('cart') || '[]';
                const arr = JSON.parse(raw);
                if (!Array.isArray(arr)) return [];
                // garantir shape
                return arr.map(it => Object.assign({ qty: Number(it.qty || 0) || 0 }, it));
            } catch (err) {
                console.error('cart.read error', err);
                return [];
            }
        }
        function writeCart(cart) {
            localStorage.setItem('cart', JSON.stringify(cart));
            // notifica outras partes se necessário
            window.dispatchEvent(new Event('cart:updated'));
            // sincroniza badge
            updateCartBadge();
        }
        function updateCartBadge() {
            if (!cartBadge) {
                // tenta recriar badge dentro do header .cart__page
                cartBadge = document.querySelector('#cart-badge, #number-text, [data-cart-badge], .cart-badge');
                if (!cartBadge) {
                    const parent = document.querySelector('.cart__page') || document.querySelector('.nav__actions') || document.body;
                    const span = document.createElement('span');
                    span.id = 'cart-badge';
                    span.className = 'cart-badge';
                    span.style.minWidth = '18px';
                    span.style.display = 'inline-block';
                    span.style.textAlign = 'center';
                    span.style.padding = '2px 6px';
                    span.style.borderRadius = '999px';
                    span.style.background = 'var(--first-color)';
                    span.style.color = 'white';
                    span.style.fontSize = '0.85rem';
                    span.style.fontWeight = '700';
                    parent.appendChild(span);
                    cartBadge = span;
                }
            }
            const cart = readCart();
            const total = cart.reduce((s, i) => s + (Number(i.qty) || 0), 0);
            cartBadge.textContent = total > 0 ? String(total) : '';
            if (window.gsap) gsap.fromTo(cartBadge, { scale: 0.8 }, { scale: 1, duration: 0.28, ease: 'elastic.out(1,0.6)' });
        }

        function addToCart(item) {
            const cart = readCart();
            const idx = cart.findIndex(i => String(i.id) === String(item.id));
            if (idx > -1) cart[idx].qty = Number(cart[idx].qty || 0) + (Number(item.qty) || 1);
            else cart.push(Object.assign({}, item, { qty: Number(item.qty) || 1 }));
            writeCart(cart);
        }

        // bind do botão comprar
        if (buyBtn) {
            buyBtn.addEventListener('click', () => {
                // se existir CartApp, usa ele
                const productEntry = {
                    id: product.id,
                    title: product.name,
                    price: product.price,
                    img: product.img,
                    qty: 1
                };

                if (window.CartApp && typeof window.CartApp.addToCart === 'function') {
                    window.CartApp.addToCart(productEntry);
                } else {
                    addToCart(productEntry);
                }
                localToast('Adicionado ao carrinho ✔');
            });
        }

        // init badge
        updateCartBadge();
        // atualiza badge quando localStorage mudar
        window.addEventListener('storage', (e) => {
            if (e.key === 'cart' || e.key === null) updateCartBadge();
        });
        // custom event
        window.addEventListener('cart:updated', () => updateCartBadge());

        /* ================ CEP: consulta ViaCEP + cálculo simples ================ */
        async function calcFrete(cepRaw) {
            const cepDigits = String(cepRaw || '').replace(/\D/g, '');
            if (cepDigits.length !== 8) {
                localToast('Insira um CEP válido (ex: 01001-000)');
                return;
            }

            const { shippingResult, shipText, shipPrice } = ensureShippingElements();

            // loading
            shipText.textContent = 'Consultando CEP...';
            shipPrice.textContent = '';
            showNode(shippingResult);

            try {
                const resp = await fetch(`https://viacep.com.br/ws/${cepDigits}/json/`);
                if (!resp.ok) throw new Error('Network response error');
                const data = await resp.json();
                if (data.erro) {
                    hideNode(shippingResult);
                    localToast('CEP não encontrado');
                    return;
                }

                // regra de frete de exemplo (troque pela sua)
                const lastDigit = Number(cepDigits.slice(-1));
                const prazo = 1 + (lastDigit % 5);
                const price = (10 + (lastDigit % 5) * 4).toFixed(2);

                shipText.textContent = `${prazo} dia(s) úteis • ${prazo <= 2 ? 'Entrega rápida' : 'Padrão'}`;
                shipPrice.textContent = `R$ ${price}`;

                // adição de classes/dados pra estilo ou regras adelante
                shippingResult.classList.add('frete-calculado');
                shippingResult.dataset.freightPrice = price;
                shippingResult.dataset.freightDays = String(prazo);

                showNode(shippingResult);
                localToast(`Frete calculado: R$ ${price} • ${prazo} dia(s)`);

            } catch (err) {
                console.error('calcFrete error', err);
                hideNode(getEl('shippingResult'));
                localToast('Erro ao consultar CEP. Tente novamente.');
            }
        }

        // eventos do CEP (click + enter)
        if (cepBtn && cepInput) {
            cepBtn.addEventListener('click', () => calcFrete(cepInput.value));
            cepInput.addEventListener('keydown', (ev) => {
                if (ev.key === 'Enter') {
                    ev.preventDefault();
                    calcFrete(cepInput.value);
                }
            });
        } else {
            // se não tiver input/btn — nada a fazer, apenas informe no console
            console.info('CEP não ativo: #cepInput ou #cepBtn não encontrados.');
        }

        /* ================ GERA PRODUTOS RELACIONADOS (3) ================ */
        if (relatedContainer) {
            relatedContainer.innerHTML = '';
            const others = PRODUCTS.filter(p => String(p.id) !== String(product.id)).slice(0, 3);
            others.forEach(p => {
                const card = document.createElement('div');
                card.className = `product-card ${p.category || ''}`;
                card.dataset.id = p.id;
                card.dataset.name = p.name;
                card.dataset.price = p.price;
                card.innerHTML = `
          <div class="product-image"><img src="${p.img}" alt="${p.name}"></div>
          <h3 class="product-title">${p.name}</h3>
          <p class="product-price">${p.price}</p>
          <a href="item.html?id=${p.id}" class="btn__product">Ver Item</a>
        `;
                relatedContainer.appendChild(card);
            });
        }

        /* ================ DEBUG: instruções rápidas se algo falhar ================ */
        // Se o CEP não funcionar, abra DevTools -> Console e verifique logs de network para /viacep.com.br.
        // Teste os CEPs: 01001-000 (SP), 20040-030 (RJ).
    }); // DOMContentLoaded
})(); // IIFE


// geral/js/products-admin.js
(function() {
  'use strict';

  document.addEventListener('DOMContentLoaded', () => {

    const sess = window.AuthDemo?.getSession();
    const isAdmin = sess?.role === 'admin';

    const container = document.getElementById("products-container");
    if (!container) return;

    function renderProducts() {
      const products = window.ProductsApp?.getProducts() || [];
      container.innerHTML = "";

      products.forEach(p => {
        const card = document.createElement("div");
        card.className = "product-card";
        card.dataset.id = p.id;
        card.dataset.category = p.category;

        const imgSrc = p.img || 'geral/img/placeholder.png';
        card.innerHTML = `
          <div class="product-image"><img src="${imgSrc}" alt="${p.name}" onerror="this.src='geral/img/placeholder.png'"></div>
          <h3 class="product-title">${p.name}</h3>
          <p class="product-price">${p.price}</p>
          <a href="item.html?id=${encodeURIComponent(p.id)}" class="btn__product">Ver Item</a>
          ${isAdmin ? '<button class="remove-btn">Remover</button>' : ''}
        `;

        if (isAdmin) {
          card.querySelector(".remove-btn").addEventListener("click", () => removeProduct(p.id));
        }

        container.appendChild(card);
      });
    }

    function removeProduct(id) {
      let products = window.ProductsApp?.getProducts() || [];
      products = products.filter(p => String(p.id) !== String(id));
      localStorage.setItem('products', JSON.stringify(products));
      window.ProductsApp.PRODUCTS = products; // atualiza o único ponto de dados
      renderProducts();
      localToast && localToast('Produto removido', 'success');
    }

    renderProducts();

    // re-renderiza se a sessão mudar (botão admin aparece/desaparece)
    window.addEventListener('session:changed', () => renderProducts());
  });

})();

// geral/js/products-cards.js
(function() {
  'use strict';

  document.addEventListener('DOMContentLoaded', () => {

    const containerSelector = '#products-container'; // onde os cards vão aparecer
    const container = document.querySelector(containerSelector);
    if (!container) return;

    // Pega produtos do ponto único de verdade
    const products = window.ProductsApp?.getProducts() || [];

    container.innerHTML = ''; // limpa container

    products.forEach(p => {
      const card = document.createElement('div');
      card.className = 'product-card';
      card.dataset.id = p.id;
      card.dataset.category = p.category;

      const imgSrc = p.img || 'geral/img/placeholder.png';
      card.innerHTML = `
        <div class="product-image"><img src="${imgSrc}" alt="${p.name}" onerror="this.src='geral/img/placeholder.png'"></div>
        <h3 class="product-title">${p.name}</h3>
        <p class="product-price">${p.price}</p>
        <a href="item.html?id=${encodeURIComponent(p.id)}" class="btn__product">Ver Item</a>
      `;

      container.appendChild(card);
    });
  });
})();

<!-- // combined-all.js — concatenação dos arquivos enviados pelo usuário

/* ======= Begin file: products.js ======= */
// window.ProductsApp — ponto único de verdade
window.ProductsApp = window.ProductsApp || {};

// Produtos já armazenados / fallback demo
window.ProductsApp.getProducts = function() {
    if (Array.isArray(window.PRODUCTS) && window.PRODUCTS.length) return window.PRODUCTS;
    
    // fallback localStorage
    try {
        const saved = JSON.parse(localStorage.getItem('products') || '[]');
        if (Array.isArray(saved) && saved.length) {
            window.PRODUCTS = saved;
            return saved;
        }
    } catch(e) { /* ignore */ }

    // se ainda não existir, cria demo
    const demo = [
        {
            id: "1",
            name: "Headphone Cyber Drivers 40mm, Bluetooth, Preto",
            img: "geral/img/perifericos/headset.png",
            price: "R$ 169,99",
            sku: "HD-1234",
            category: "perifericos"
        },
        {
            id: "2",
            name: "Placa Mãe Gigabyte B550M, AMD AM4, Micro ATX",
            img: "geral/img/placa-giga.png",
            price: "R$ 899,99",
            sku: "MB-5678",
            category: "hardware"
        },
        {
            id: "3",
            name: "Placa Mãe Gigabyte B550M, AMD AM4, Micro ATX",
            img: "geral/img/placa-giga.png",
            price: "R$ 899,99",
            sku: "MB-5678",
            category: "hardware"
        }
      ];

    window.PRODUCTS = demo;
    localStorage.setItem('products', JSON.stringify(demo));
    return demo;
};


/* ======= End file: products.js ======= */

/* ======= Begin file: products-card.js ======= */
// geral/js/products-cards.js
(function() {
  'use strict';

  document.addEventListener('DOMContentLoaded', () => {

    const containerSelector = '#products-container'; // onde os cards vão aparecer
    const container = document.querySelector(containerSelector);
    if (!container) return;

    // Pega produtos do ponto único de verdade
    const products = window.ProductsApp?.getProducts() || [];

    container.innerHTML = ''; // limpa container

    products.forEach(p => {
      const card = document.createElement('div');
      card.className = 'product-card';
      card.dataset.id = p.id;
      card.dataset.category = p.category;

      const imgSrc = p.img || 'geral/img/placeholder.png';
      card.innerHTML = `
        <div class="product-image"><img src="${imgSrc}" alt="${p.name}" onerror="this.src='geral/img/placeholder.png'"></div>
        <h3 class="product-title">${p.name}</h3>
        <p class="product-price">${p.price}</p>
        <a href="item.html?id=${encodeURIComponent(p.id)}" class="btn__product">Ver Item</a>
      `;

      container.appendChild(card);
    });
  });
})();


/* ======= End file: products-card.js ======= */

/* ======= Begin file: products-admin.js ======= */
// geral/js/products-admin.js
(function() {
  'use strict';

  document.addEventListener('DOMContentLoaded', () => {

    const sess = window.AuthDemo?.getSession();
    const isAdmin = sess?.role === 'admin';

    const container = document.getElementById("products-container");
    if (!container) return;

    function renderProducts() {
      const products = window.ProductsApp?.getProducts() || [];
      container.innerHTML = "";

      products.forEach(p => {
        const card = document.createElement("div");
        card.className = "product-card";
        card.dataset.id = p.id;
        card.dataset.category = p.category;

        const imgSrc = p.img || 'geral/img/placeholder.png';
        card.innerHTML = `
          <div class="product-image"><img src="${imgSrc}" alt="${p.name}" onerror="this.src='geral/img/placeholder.png'"></div>
          <h3 class="product-title">${p.name}</h3>
          <p class="product-price">${p.price}</p>
          <a href="item.html?id=${encodeURIComponent(p.id)}" class="btn__product">Ver Item</a>
          ${isAdmin ? '<button class="remove-btn">Remover</button>' : ''}
        `;

        if (isAdmin) {
          card.querySelector(".remove-btn").addEventListener("click", () => removeProduct(p.id));
        }

        container.appendChild(card);
      });
    }

    function removeProduct(id) {
      let products = window.ProductsApp?.getProducts() || [];
      products = products.filter(p => String(p.id) !== String(id));
      localStorage.setItem('products', JSON.stringify(products));
      window.ProductsApp.PRODUCTS = products; // atualiza o único ponto de dados
      renderProducts();
      localToast && localToast('Produto removido', 'success');
    }

    renderProducts();

    // re-renderiza se a sessão mudar (botão admin aparece/desaparece)
    window.addEventListener('session:changed', () => renderProducts());
  });

})();


/* ======= End file: products-admin.js ======= */

/* ======= Begin file: item.js ======= */
/* geral/js/item.js  — Versão robusta (substituir arquivo atual) */
/* Dependências opcionais: gsap (para animações). Usa ViaCEP para consulta de CEP. */

(function () {
    'use strict';

    document.addEventListener('DOMContentLoaded', () => {
        /* ================= CONFIG / PRODUTOS (usa window.products se existir) ================= */
        const PRODUCTS = window.products || [
            {
                id: "1",
                name: "Headphone Cyber Drivers 40mm, Bluetooth, Preto",
                img: "geral/img/perifericos/headset.png",
                price: "R$ 169,99",
                sku: "HD-1234",
                brandMeta: "Produto • Linhagem Tech",
                description: "Headphone Bluetooth com drivers de 40mm...",
                installments: "ou 6x de R$ 28,33 sem juros",
                stock: "Em estoque • Envio rápido",
                rating: 4.5,
                reviewText: "Produto bem avaliado por conforto e som limpo",
                category: "periferico"
            },
            {
                id: "2",
                name: "Placa Mãe Gigabyte B550M, AMD AM4, Micro ATX",
                img: "geral/img/placa-giga.png",
                price: "R$ 899,99",
                sku: "MB-5678",
                brandMeta: "Produto • Linhagem Tech",
                description: "Placa mãe AMD B550M com suporte DDR4...",
                installments: "ou 12x de R$ 74,99 sem juros",
                stock: "Em estoque • Envio rápido",
                rating: 4.8,
                reviewText: "Altamente confiável e durável",
                category: "hardware"
            },
            {
                id: "3",
                name: "Placa Mãe Gigabyte B550M, AMD AM4, Micro ATX",
                img: "geral/img/placa-giga.png",
                price: "R$ 899,99",
                sku: "MB-5678",
                brandMeta: "Produto • Linhagem Tech",
                description: "Placa mãe AMD B550M com suporte DDR4...",
                installments: "ou 12x de R$ 74,99 sem juros",
                stock: "Em estoque • Envio rápido",
                rating: 4.8,
                reviewText: "Altamente confiável e durável",
                category: "hardware"
            }
            
        ];

        /* ================= ELEMENTOS DO DOM ================= */
        const getEl = id => document.getElementById(id);

        const titleEl = getEl('title');
        const descEl = getEl('desc');
        const priceEl = getEl('price');
        const priceBadgeEl = getEl('priceBadge');
        const productImgEl = getEl('productImg');
        const skuEl = getEl('sku');
        const brandMetaEl = getEl('brandMeta');
        const installmentsEl = getEl('installments');
        const stockEl = getEl('stock');
        const reviewStarsEl = getEl('reviewStars');
        const reviewTextEl = getEl('reviewText');
        const relatedContainer = getEl('relatedProducts');

        const buyBtn = getEl('buyBtn');
        // cart badge in header — tenta vários seletores conhecidos
        let cartBadge = document.querySelector('#cart-badge, #number-text, [data-cart-badge], .cart-badge');

        // CEP elements (podem ser null — tratamos)
        const cepInput = getEl('cepInput');
        const cepBtn = getEl('cepBtn');

        // helper: cria shippingResult se não existir e retorna referências
        function ensureShippingElements() {
            let shippingResult = getEl('shippingResult');
            let shipText = getEl('shipText');
            let shipPrice = getEl('shipPrice');

            if (!shippingResult) {
                shippingResult = document.createElement('div');
                shippingResult.id = 'shippingResult';
                // manter compatibilidade com seu CSS (classe .show aplicada pelo JS)
                shippingResult.style.display = 'none';
                shippingResult.style.marginTop = '0.6rem';
                // inserir após o bloco do CEP se possível, senão no final do aside
                if (cepInput && cepInput.parentNode) cepInput.parentNode.insertAdjacentElement('afterend', shippingResult);
                else {
                    const aside = document.querySelector('.info') || document.body;
                    aside.appendChild(shippingResult);
                }
            }
            if (!shipText) {
                shipText = document.createElement('span');
                shipText.id = 'shipText';
                shippingResult.appendChild(shipText);
            }
            if (!shipPrice) {
                shipPrice = document.createElement('span');
                shipPrice.id = 'shipPrice';
                shipPrice.style.marginLeft = '0.5rem';
                shippingResult.appendChild(shipPrice);
            }
            return { shippingResult, shipText, shipPrice };
        }

        /* ================ UTIL: Toast (usa showToast se já existir) ================ */
// Container para todas as notificações
if (!document.getElementById('toast-container')) {
    const container = document.createElement('div');
    container.id = 'toast-container';
    Object.assign(container.style, {
        position: 'fixed',
        top: '80px',
        right: '20px',
        display: 'flex',
        flexDirection: 'column',
        gap: '10px', // espaço entre notificações
        zIndex: 99999,
        pointerEvents: 'none'
    });
    document.body.appendChild(container);
}

function localToast(msg) {
    const container = document.getElementById('toast-container');
    if (!container) return;

    const t = document.createElement('div');
    t.textContent = msg;

    Object.assign(t.style, {
        maxWidth: '300px',
        background: `linear-gradient(90deg, var(--first-color), var(--first-color-alt))`,
        color: `white`,
        padding: '12px 16px',
        borderRadius: '8px',
        boxShadow: '0 8px 20px rgba(0,0,0,0.25)',
        fontSize: '14px',
        lineHeight: '1.4',
        opacity: 0,
        transform: 'translateY(-20px)',
        pointerEvents: 'auto',
        transition: 'all 0.4s ease'
    });

    container.appendChild(t);

    // Entrada animada
    if (window.gsap) {
        gsap.to(t, { opacity: 1, y: 0, duration: 0.3, ease: "power2.out" });
    } else {
        t.style.opacity = 1;
        t.style.transform = 'translateY(0)';
    }

    // Remove após 1,5s
    setTimeout(() => {
        if (window.gsap) {
            gsap.to(t, { opacity: 0, y: -20, duration: 0.4, ease: "power2.in", onComplete: () => t.remove() });
        } else {
            t.remove();
        }
    }, 1500);
}



        /* ================ UTIL: anima show/hide com gsap fallback ================ */
        function showNode(node) {
            if (!node) return;
            node.style.display = 'flex';
            node.classList && node.classList.add('show');
            if (window.gsap && typeof gsap.fromTo === 'function') {
                gsap.fromTo(node, { opacity: 0, y: 8 }, { opacity: 1, y: 0, duration: 0.35 });
            } else {
                node.style.opacity = 0;
                node.style.transform = 'translateY(8px)';
                requestAnimationFrame(() => {
                    node.style.transition = 'opacity .35s, transform .35s';
                    node.style.opacity = 1;
                    node.style.transform = 'translateY(0)';
                });
            }
        }

        function hideNode(node) {
            if (!node) return;
            if (window.gsap && typeof gsap.to === 'function') {
                gsap.to(node, { opacity: 0, y: 8, duration: 0.28, onComplete: () => { node.style.display = 'none'; node.classList && node.classList.remove('show'); } });
            } else {
                node.style.transition = 'opacity .28s, transform .28s';
                node.style.opacity = 0;
                node.style.transform = 'translateY(8px)';
                setTimeout(() => { node.style.display = 'none'; node.classList && node.classList.remove('show'); }, 300);
            }
        }

        /* ================ MÁSCARA SIMPLES PARA CEP (00000-000) ================ */
        function cepMask(e) {
            const el = e.target;
            let v = el.value.replace(/\D/g, '').slice(0, 8);
            if (v.length > 5) v = v.slice(0, 5) + '-' + v.slice(5);
            el.value = v;
        }
        if (cepInput) {
            cepInput.addEventListener('input', cepMask);
        }

        /* ================ PEGAR PRODUTO (pela querystring id) ================ */
        const params = new URLSearchParams(window.location.search);
        const productId = params.get('id');
        const product = PRODUCTS.find(p => p.id === productId) || PRODUCTS[0];
        if (!product) {
            console.warn('Item: produto não encontrado e não há fallback.');
            return;
        }

        /* ================ POPULA DETALHES DO PRODUTO ================ */
        function setProduct(product) {
            if (titleEl) titleEl.textContent = product.name || 'Produto';
            if (descEl) descEl.textContent = product.description || '';
            if (priceEl) priceEl.textContent = product.price || 'R$ 0,00';
            if (priceBadgeEl) priceBadgeEl.textContent = product.price || 'R$ 0,00';
            if (productImgEl && product.img) productImgEl.src = product.img;
            if (skuEl) skuEl.textContent = `SKU: ${product.sku || '—'}`;
            if (brandMetaEl) brandMetaEl.textContent = product.brandMeta || '';
            if (installmentsEl) installmentsEl.textContent = product.installments || '';
            if (stockEl) stockEl.textContent = product.stock || '';
            if (reviewStarsEl) {
                reviewStarsEl.innerHTML = '';
                for (let i = 0; i < 5; i++) {
                    const s = document.createElement('span');
                    s.textContent = i < Math.floor((product.rating || 0)) ? '★' : '☆';
                    // pequenos delays para efeito (se quiser)
                    s.style.opacity = 1;
                    s.style.marginRight = '2px';
                    reviewStarsEl.appendChild(s);
                }
            }
            if (reviewTextEl) reviewTextEl.textContent = product.reviewText || '';
        }
        setProduct(product);

        /* ================ CARRINHO: utilitários ================ */
        function readCart() {
            try {
                const raw = localStorage.getItem('cart') || '[]';
                const arr = JSON.parse(raw);
                if (!Array.isArray(arr)) return [];
                // garantir shape
                return arr.map(it => Object.assign({ qty: Number(it.qty || 0) || 0 }, it));
            } catch (err) {
                console.error('cart.read error', err);
                return [];
            }
        }
        function writeCart(cart) {
            localStorage.setItem('cart', JSON.stringify(cart));
            // notifica outras partes se necessário
            window.dispatchEvent(new Event('cart:updated'));
            // sincroniza badge
            updateCartBadge();
        }
        function updateCartBadge() {
            if (!cartBadge) {
                // tenta recriar badge dentro do header .cart__page
                cartBadge = document.querySelector('#cart-badge, #number-text, [data-cart-badge], .cart-badge');
                if (!cartBadge) {
                    const parent = document.querySelector('.cart__page') || document.querySelector('.nav__actions') || document.body;
                    const span = document.createElement('span');
                    span.id = 'cart-badge';
                    span.className = 'cart-badge';
                    span.style.minWidth = '18px';
                    span.style.display = 'inline-block';
                    span.style.textAlign = 'center';
                    span.style.padding = '2px 6px';
                    span.style.borderRadius = '999px';
                    span.style.background = 'var(--first-color)';
                    span.style.color = 'white';
                    span.style.fontSize = '0.85rem';
                    span.style.fontWeight = '700';
                    parent.appendChild(span);
                    cartBadge = span;
                }
            }
            const cart = readCart();
            const total = cart.reduce((s, i) => s + (Number(i.qty) || 0), 0);
            cartBadge.textContent = total > 0 ? String(total) : '';
            if (window.gsap) gsap.fromTo(cartBadge, { scale: 0.8 }, { scale: 1, duration: 0.28, ease: 'elastic.out(1,0.6)' });
        }

        function addToCart(item) {
            const cart = readCart();
            const idx = cart.findIndex(i => String(i.id) === String(item.id));
            if (idx > -1) cart[idx].qty = Number(cart[idx].qty || 0) + (Number(item.qty) || 1);
            else cart.push(Object.assign({}, item, { qty: Number(item.qty) || 1 }));
            writeCart(cart);
        }

        // bind do botão comprar
        if (buyBtn) {
            buyBtn.addEventListener('click', () => {
                // se existir CartApp, usa ele
                const productEntry = {
                    id: product.id,
                    title: product.name,
                    price: product.price,
                    img: product.img,
                    qty: 1
                };

                if (window.CartApp && typeof window.CartApp.addToCart === 'function') {
                    window.CartApp.addToCart(productEntry);
                } else {
                    addToCart(productEntry);
                }
                localToast('Adicionado ao carrinho ✔');
            });
        }

        // init badge
        updateCartBadge();
        // atualiza badge quando localStorage mudar
        window.addEventListener('storage', (e) => {
            if (e.key === 'cart' || e.key === null) updateCartBadge();
        });
        // custom event
        window.addEventListener('cart:updated', () => updateCartBadge());

        /* ================ CEP: consulta ViaCEP + cálculo simples ================ */
        async function calcFrete(cepRaw) {
            const cepDigits = String(cepRaw || '').replace(/\D/g, '');
            if (cepDigits.length !== 8) {
                localToast('Insira um CEP válido (ex: 01001-000)');
                return;
            }

            const { shippingResult, shipText, shipPrice } = ensureShippingElements();

            // loading
            shipText.textContent = 'Consultando CEP...';
            shipPrice.textContent = '';
            showNode(shippingResult);

            try {
                const resp = await fetch(`https://viacep.com.br/ws/${cepDigits}/json/`);
                if (!resp.ok) throw new Error('Network response error');
                const data = await resp.json();
                if (data.erro) {
                    hideNode(shippingResult);
                    localToast('CEP não encontrado');
                    return;
                }

                // regra de frete de exemplo (troque pela sua)
                const lastDigit = Number(cepDigits.slice(-1));
                const prazo = 1 + (lastDigit % 5);
                const price = (10 + (lastDigit % 5) * 4).toFixed(2);

                shipText.textContent = `${prazo} dia(s) úteis • ${prazo <= 2 ? 'Entrega rápida' : 'Padrão'}`;
                shipPrice.textContent = `R$ ${price}`;

                // adição de classes/dados pra estilo ou regras adelante
                shippingResult.classList.add('frete-calculado');
                shippingResult.dataset.freightPrice = price;
                shippingResult.dataset.freightDays = String(prazo);

                showNode(shippingResult);
                localToast(`Frete calculado: R$ ${price} • ${prazo} dia(s)`);

            } catch (err) {
                console.error('calcFrete error', err);
                hideNode(getEl('shippingResult'));
                localToast('Erro ao consultar CEP. Tente novamente.');
            }
        }

        // eventos do CEP (click + enter)
        if (cepBtn && cepInput) {
            cepBtn.addEventListener('click', () => calcFrete(cepInput.value));
            cepInput.addEventListener('keydown', (ev) => {
                if (ev.key === 'Enter') {
                    ev.preventDefault();
                    calcFrete(cepInput.value);
                }
            });
        } else {
            // se não tiver input/btn — nada a fazer, apenas informe no console
            console.info('CEP não ativo: #cepInput ou #cepBtn não encontrados.');
        }

        /* ================ GERA PRODUTOS RELACIONADOS (3) ================ */
        if (relatedContainer) {
            relatedContainer.innerHTML = '';
            const others = PRODUCTS.filter(p => String(p.id) !== String(product.id)).slice(0, 3);
            others.forEach(p => {
                const card = document.createElement('div');
                card.className = `product-card ${p.category || ''}`;
                card.dataset.id = p.id;
                card.dataset.name = p.name;
                card.dataset.price = p.price;
                card.innerHTML = `
          <div class="product-image"><img src="${p.img}" alt="${p.name}"></div>
          <h3 class="product-title">${p.name}</h3>
          <p class="product-price">${p.price}</p>
          <a href="item.html?id=${p.id}" class="btn__product">Ver Item</a>
        `;
                relatedContainer.appendChild(card);
            });
        }

        /* ================ DEBUG: instruções rápidas se algo falhar ================ */
        // Se o CEP não funcionar, abra DevTools -> Console e verifique logs de network para /viacep.com.br.
        // Teste os CEPs: 01001-000 (SP), 20040-030 (RJ).
    }); // DOMContentLoaded
})(); // IIFE


/* ======= End file: item.js ======= */

 -->


corrigir parcelamento no cart 
corrigir a categoria de destaques 
estilizar css 
organizar o código
criar um código para filtrar tudo
aplicar o funcionamento da barra de pesquisa 
chatbot